<div (click)="closeModal()" *ngIf="show" class="modal-bg"></div>

<div *ngIf="show" class="modal w-1/4 h-auto text-gray-800">
  <div class="modal-header h-1/5 flex justify-between items-center mb-3">
    <h5 class="modal-title font-bold text-lg">Add a feedback for flight {{ flightNumber }}</h5>
    <button (click)="closeModal()" class="text-xl font-bold">Ã—</button>
  </div>
  <form (ngSubmit)="submitCreateFeedback()"
        [formGroup]="createFeedbackForm"
        autocomplete="off"
        class="space-y-4">
    <div class="modal-body h-3/5">

      <div class="flex flex-col mb-2">
        <label class="mb-1 font-semibold" for="passengerUsername">Passenger</label>
        <select [class.is-invalid]="passengerUsername.invalid && passengerUsername.touched"
                [class.is-valid]="passengerUsername.valid && passengerUsername.touched"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-auto p-2.5"
                formControlName="passengerUsername"
                id="passengerUsername">
          <option *ngFor="let eligiblePassenger of eligiblePassengers"
                  [value]="eligiblePassenger.username">{{ eligiblePassenger.name }} ({{ eligiblePassenger.username }})
          </option>
        </select>
      </div>

      <div class="flex flex-col mb-2">
        <label class="mb-1 font-semibold">Rating</label>
        <app-star-rating (ratingChange)="updateRating($event)" [enabled]="true" [rating]="0"></app-star-rating>
        <div *ngIf="rating.invalid && rating.touched"
             class="text-red-500 text-sm">
          <div *ngIf="rating.errors?.['required']">Rating is required</div>
          <div *ngIf="rating.errors?.['max']">Rating must be at least 1</div>
          <div *ngIf="rating.errors?.['min']">Rating must be at most 0</div>
        </div>
      </div>


      <div class="flex flex-col mb-2">
        <label class="mb-1 font-semibold" for="comment">Comment</label>
        <textarea [class.is-invalid]="comment.invalid && comment.touched"
                  [class.is-valid]="comment.valid && comment.touched"
                  class="p-2 border rounded" formControlName="comment" id="comment" name="comment"
                  type="text"> </textarea>
        <div *ngIf="comment.invalid && comment.touched"
             class="text-red-500 text-sm">
          <div *ngIf="comment.errors?.['required']">Comment is required</div>
          <div *ngIf="comment.errors?.['maxlength']">Comment must be no longer than 500 characters</div>
        </div>
      </div>

    </div>
    <div class="modal-footer h-1/5 flex justify-end space-x-4 mt-4">
      <button
        (click)="closeModal()"
        class="text-white focus:ring-4 focus:outline-none font-medium rounded-lg text-base px-5 py-2.5 text-center bg-red-600 hover:bg-red-700 focus:ring-red-800"
        type="button">Close
      </button>
      <button
        class="text-white focus:ring-4 focus:outline-none font-medium rounded-lg text-base px-5 py-2.5 text-center bg-green-600 hover:bg-green-700 focus:ring-green-800"
        type="submit">Add feedback
      </button>
    </div>
  </form>
</div>
